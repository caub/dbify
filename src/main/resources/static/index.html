<!DOCTYPE html>
<html>
<head>
    <title>Hello</title>
    <script src="//code.jquery.com/jquery-1.11.2.min.js"></script>
    <script type="text/javascript">
    
    function post(data){
    	return new Promise(function(resolve, reject) {
    		var req = new XMLHttpRequest();
            req.open("POST", "/mongo?method="+data[0]);
            req.setRequestHeader("Content-type", "application/json");
            req.setRequestHeader("Accept", "application/json");
            req.onload = function() {
    			if (req.status == 200) {
    				resolve(req.response);
    			}
    			else {
    				reject(Error(req.statusText));
    			}
            };

            req.onerror = function() {
    			reject(Error("Erreur réseau"));
            };

            req.send(data[1]);
    	});
    }

    
    $(document).ready(function() {
    	$("button").click(function() {
    		// now chain all selected textarea
    		$("input:checked").each(function(_,i) {$(i).next().next().val("")})
    		
    		var promise = Promise.resolve();
    		$("input:checked")
    		.each(function(_,i) {
    			var data = $(i).next().val().split(/\ (.+)?/,2)
				promise = promise
					.then(function() { return post(data); })
					.then(function(response) { $(i).next().next().val(response) });
			})
    		
           	
        });
    })
    
    
    
    
    </script>
</head>
<body>
<a href="https://github.com/cauburtin/mongo-cli-spring"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"></a>

<h1>Mongo Cli</h1>
<p>Mongo Cli is a server for executing MongoDB commands in the <a href="http://api.mongodb.org/java/current/com/mongodb/DBCollection.html">Java api</a></p>

<button class="method" style="margin-left: 445px;">send</button>
<div>
	<input type="checkbox" checked>
	<textarea class="input" rows="1" cols="60">find {"hello": 1}</textarea>
	<textarea class="output" rows="1" cols="60" placeholder="result..."></textarea>
</div>
<div>
	<input type="checkbox">
	<textarea class="input" rows="1" cols="60">findOne {"hello": 1}</textarea>
	<textarea class="output" rows="1" cols="60" placeholder="result..."></textarea>
</div>
<div>
	<input type="checkbox" checked>
	<textarea class="input" rows="1" cols="60">count {"hello": 1}</textarea>
	<textarea class="output" rows="1" cols="60" placeholder="result..."></textarea>
</div>
<div>
	<input type="checkbox" checked>
	<textarea class="input" rows="1" cols="60">count {"hello": 2}</textarea>
	<textarea class="output" rows="1" cols="60" placeholder="result..."></textarea>
</div>
<div>
	<input type="checkbox" checked>
	<textarea class="input" rows="1" cols="60">insert {"hello": 1}</textarea>
	<textarea class="output" rows="1" cols="60" placeholder="result..."></textarea>
</div>
<div>
	<input type="checkbox">
	<textarea class="input" rows="1" cols="60">save {"hello": 2}</textarea>
	<textarea class="output" rows="1" cols="60" placeholder="result..."></textarea>
</div>
<div>
	<input type="checkbox" checked>
	<textarea class="input" rows="1" cols="60">count {"hello": 1}</textarea>
	<textarea class="output" rows="1" cols="60" placeholder="result..."></textarea>
</div>
<div>
	<input type="checkbox">
	<textarea class="input" rows="1" cols="60">update [{"hello": 1},{"hello": 2},false,false]</textarea>
	<textarea class="output" rows="1" cols="60" placeholder="result..."></textarea>
</div>
<div>
	<input type="checkbox" checked>
	<textarea class="input" rows="1" cols="60">update [{"hello": 1},{"$set":{"hello": 2}},false,true]</textarea>
	<textarea class="output" rows="1" cols="60" placeholder="result..."></textarea>
</div>
<div>
	<input type="checkbox">
	<textarea class="input" rows="1" cols="60">update [{"hello": 3},{"$set":{"hello": 2}},true,true]</textarea>
	<textarea class="output" rows="1" cols="60" placeholder="result..."></textarea>
</div>
<div>
	<input type="checkbox">
	<textarea class="input" rows="1" cols="60">findAndModify [{"hello": 1},{"hello": 2}]</textarea>
	<textarea class="output" rows="1" cols="60" placeholder="result..."></textarea>
</div>
<div>
	<input type="checkbox" checked>
	<textarea class="input" rows="1" cols="60">count {"hello": 2}</textarea>
	<textarea class="output" rows="1" cols="60" placeholder="result..."></textarea>
</div>
<div>
	<input type="checkbox">
	<textarea class="input" rows="1" cols="60">remove {"hello": 2}</textarea>
	<textarea class="output" rows="1" cols="60" placeholder="result..."></textarea>
</div>
<div>
	<input type="checkbox" checked>
	<textarea class="input" rows="1" cols="60">remove {"hello": {"$exists": true}}</textarea>
	<textarea class="output" rows="1" cols="60" placeholder="result..."></textarea>
</div>
<div>
	<input type="checkbox" checked>
	<textarea class="input" rows="1" cols="60">count {"hello": 2}</textarea>
	<textarea class="output" rows="1" cols="60" placeholder="result..."></textarea>
</div>


</body>
</html>